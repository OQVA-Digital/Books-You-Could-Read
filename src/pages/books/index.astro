---
import { type CollectionEntry, getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

import "../../styles/books.css"

const books = (await getCollection('books')).sort(
  (a, b) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf()
);

type Props = CollectionEntry<'books'>;

export async function getStaticPaths() {
  const books = await getCollection('books');
  return books.map((book) => ({
    params: { slug: book.slug },
    props: book,
  }));
}

const book = Astro.props;
---

<Layout {...book.data}>
	<main>
		<section>
			<ul>
				{books.map((book) => (
				  <li>
					<a href={`/books/${book.slug}/`} style={{ '--highlight-color': book.data.highlightColor }}>
					  <span class="title">{book.data.title}</span>, by {book.data.bookAuthor}
					</a>
					<hr />
				  </li>
				))}
			</ul>
		</section>
	</main>
</Layout>

<style>
	ul li a:hover .title {
		color: var(--highlight-color, var(--c1));
		transition: color 0s ease;
		-webkit-transition: color 0s ease;
		-moz-transition: color 0s ease;
		-ms-transition: color 0s ease;
		-o-transition: color 0s ease;
	}
</style>